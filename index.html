<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Windows 7 Ultimate - Pro Drag & Shadow</title>
    <style>
        :root {
            --font-main: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            --win-blue: #1f6b9c;
        }

        * { box-sizing: border-box; user-select: none; -webkit-user-drag: none; }

        body {
            margin: 0; padding: 0;
            background-color: black;
            font-family: var(--font-main);
            overflow: hidden;
            height: 100vh; width: 100vw;
        }

        /* --- UTILS --- */
        .icon-16 { width: 16px; height: 16px; display: block; object-fit: contain; }
        .icon-48 { width: 48px; height: 48px; display: block; object-fit: contain; }
        .hidden { display: none !important; }

        /* --- MAIN FIXED EXPLORER WINDOW --- */
        #explorer-fixed {
            position: absolute; top: 0; left: 0;
            width: 100%; height: calc(100% - 40px);
            background: rgba(220, 235, 245, 1);
            display: flex; flex-direction: column;
            z-index: 1;
        }

        .title-bar {
            height: 30px;
            background: linear-gradient(to bottom, #eef7fc 0%, #bedbf1 100%);
            display: flex; align-items: center; padding: 0 10px;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }
        .title-text { flex-grow: 1; padding-left: 8px; font-size: 12px; color: #333; text-shadow: 0 1px 0 rgba(255,255,255,0.8); }

        .nav-bar {
            height: 38px; display: flex; align-items: center; padding: 0 10px; gap: 10px;
            background: #f0f0f0; border-bottom: 1px solid #d9d9d9;
        }
        .nav-buttons { display: flex; gap: 2px; }
        .circle-btn {
            width: 30px; height: 30px; border-radius: 50%;
            background: #465ad3; border: 2px solid rgba(255,255,255,0.4);
            box-shadow: inset 0 2px 5px rgba(255,255,255,0.5), 0 1px 3px rgba(0,0,0,0.4);
            display: flex; justify-content: center; align-items: center; cursor: pointer;
        }
        .small-circle { width: 24px; height: 24px; background: transparent; border: 1px solid #ccc; box-shadow: none; }
        .arrow-back { width: 0; height: 0; border-top: 6px solid transparent; border-bottom: 6px solid transparent; border-right: 8px solid white; }
        .arrow-fwd { width: 0; height: 0; border-top: 4px solid transparent; border-bottom: 4px solid transparent; border-left: 6px solid #666; }

        .address-bar {
            flex-grow: 1; height: 26px; background: white; border: 1px solid #7d8ea6;
            display: flex; align-items: center; padding: 0 5px;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.1); font-size: 12px;
        }
        
        .search-container {
            width: 220px; height: 26px; background: white; border: 1px solid #7d8ea6;
            margin-left: 10px; display: flex; align-items: center; padding-right: 5px;
        }
        .search-inp {
            border: none; outline: none; width: 100%; height: 100%;
            padding: 0 8px; font-size: 12px; font-style: italic; color: #555;
        }
        .search-icon { width: 14px; opacity: 0.5; }

        .toolbar {
            height: 32px; background: #f4f7fc; border-bottom: 1px solid #d9d9d9;
            display: flex; align-items: center; padding: 0 15px; gap: 10px;
            font-size: 12px; color: #1e1e1e;
        }
        .tool-btn { cursor: pointer; padding: 3px 8px; border: 1px solid transparent; }
        .tool-btn:hover { background: #eaf6fd; border-color: #bce1fc; }
        .btn-add { font-weight: bold; color: #0066cc; }
        .btn-empty { color: red; display: none; }

        .main-container { flex-grow: 1; display: flex; background: white; overflow: hidden; }

        .sidebar {
            width: 230px; background: #fcfcfc; border-right: 1px solid #dae5f0;
            padding-top: 10px; overflow-y: auto;
        }
        .tree-item {
            display: flex; align-items: center; padding: 3px 5px; font-size: 12px;
            cursor: pointer; border: 1px solid transparent; margin-bottom: 1px;
        }
        .tree-item:hover { background: #eff6fc; border-color: #d9ebf9; }
        .tree-item.active { background: #dceefb; border-color: #98c6ec; }
        .indent-1 { padding-left: 15px; }
        .indent-2 { padding-left: 35px; }
        .group-title { font-weight: normal; color: #1e1e1e; }

        .file-view {
            flex-grow: 1; padding: 10px;
            display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            grid-auto-rows: 100px; align-content: start; gap: 5px;
            overflow-y: auto; background: white;
        }
        .file-card {
            display: flex; flex-direction: column; align-items: center;
            padding: 5px; border: 1px solid transparent; border-radius: 3px; cursor: pointer;
            position: relative;
        }
        .file-card:hover { background: #e8f5fd; border-color: #d9ebf9; }
        .file-card.selected { background: #cce8ff; border-color: #99d1ff; }
        .file-label { font-size: 11px; text-align: center; color: #1e1e1e; word-wrap: break-word; line-height: 1.2; margin-top: 4px; }

        /* --- UPDATED POPUP WINDOWS WITH DEEP SHADOWS --- */
        #preview-window, #add-window, #del-window {
            position: absolute; top: 10%; left: 15%; width: 600px; height: 450px;
            background: rgba(245, 250, 255, 0.98);
            border-radius: 8px; 
            border: 1px solid rgba(0,0,0,0.4);
            /* EXTREME SHADOW FOR REALISM */
            box-shadow: 
                0 20px 60px rgba(0,0,0,0.6), 
                0 0 0 1px rgba(255,255,255,0.4) inset;
            display: flex; flex-direction: column; z-index: 2000;
            backdrop-filter: blur(10px);
            transition: width 0.2s, height 0.2s, transform 0.2s, opacity 0.2s;
            touch-action: none; /* DRAG ANYWHERE */
        }
        
        #add-window, #del-window { width: 400px; height: auto; }

        .popup-header {
            height: 34px; display: flex; justify-content: space-between; align-items: center;
            padding: 0 4px 0 10px; cursor: move;
            background: linear-gradient(to bottom, #ffffff 0%, #d1e1f0 100%);
            border-bottom: 1px solid #a0a0a0; border-radius: 8px 8px 0 0;
        }
        
        .win-controls { display: flex; height: 100%; align-items: center; gap: 4px; padding-right: 4px; }
        .win-btn {
            width: 30px; height: 20px; display: flex; justify-content: center;
            align-items: center; cursor: pointer; font-size: 12px;
            border-radius: 3px; background: linear-gradient(to bottom, #fff 0%, #cbd9e6 100%); 
            border: 1px solid #8e9cad; box-shadow: inset 0 1px 0 #fff;
        }
        .win-btn:hover { background: #eaf6fd; border-color: #3c7fb1; }
        .win-btn.close-btn:hover { background: #e81123; color: white; border-color: #b00b1a; box-shadow: none; }

        .popup-body {
            padding: 15px; background: #f0f0f0; flex-grow: 1;
            font-size: 13px; border-radius: 0 0 8px 8px;
        }
        .popup-content-view {
            width: 100%; height: 100%; background: #000; 
            display: flex; justify-content: center; align-items: center; overflow: hidden;
        }

        .maximized {
            top: 0 !important; left: 0 !important; width: 100% !important; height: calc(100% - 40px) !important;
            border-radius: 0 !important; border: none !important;
        }
        .minimized { transform: scale(0.5) translateY(100vh); opacity: 0; pointer-events: none; }

        .form-group { margin-bottom: 12px; }
        .form-group label { display: block; margin-bottom: 4px; color: #333; font-weight: bold; }
        .form-group input, .form-group select { width: 100%; padding: 6px; border: 1px solid #7d8ea6; border-radius: 2px; }
        .btn-win { padding: 6px 20px; border: 1px solid #707070; background: linear-gradient(to bottom, #f2f2f2, #ebebeb); cursor: pointer; border-radius: 3px; }
        .btn-win:active { background: #cce4f7; }

        /* --- TASKBAR --- */
        #taskbar {
            position: fixed; bottom: 0; left: 0; width: 100%; height: 40px;
            background: linear-gradient(to bottom, #1f2f46 0%, #111a26 100%);
            border-top: 1px solid rgba(255,255,255,0.3);
            display: flex; align-items: center; z-index: 9999;
        }
        .start-btn { width: 52px; height: 100%; display: flex; justify-content: center; align-items: center; }
        .orb-img {
            width: 36px; height: 36px; border-radius: 50%;
            background: radial-gradient(circle at 50% 50%, #2a82be 0%, #13344d 100%);
            border: 1px solid rgba(255,255,255,0.4);
            box-shadow: 0 0 10px rgba(66,182,245,0.5);
            display:flex; justify-content:center; align-items:center;
            color:white; font-weight:bold; font-size:18px; font-style:italic;
        }
        .task-item {
            height: 32px; width: 160px; background: rgba(255,255,255,0.1); 
            border-radius: 3px; display: flex; align-items: center; padding: 0 8px; gap:8px;
            cursor: pointer; margin: 0 3px; border: 1px solid rgba(255,255,255,0.2);
            color: white; font-size: 11px;
        }
        .task-item.active { background: rgba(255,255,255,0.25); border-color:rgba(255,255,255,0.6); }

        .tray-area { margin-left: auto; display: flex; align-items: center; gap: 12px; padding-right: 15px; color: white; font-size: 12px; }

    </style>
</head>
<body>

    <div id="explorer-fixed">
        <div class="title-bar">
            <img src="https://img.icons8.com/color/48/monitor--v1.png" class="icon-16" style="margin-right:6px">
            <div class="title-text">Computer</div>
        </div>

        <div class="nav-bar">
            <div class="nav-buttons">
                <div class="circle-btn"><div class="arrow-back"></div></div>
                <div class="circle-btn small-circle"><div class="arrow-fwd"></div></div>
            </div>
            <div class="address-bar">
                <img src="https://img.icons8.com/color/48/folder-invoices--v1.png" class="icon-16" style="margin-right:5px">
                <span id="address-path">Libraries > Pictures</span>
            </div>
            <div class="search-container">
                <input type="text" id="search-inp" class="search-inp" placeholder="Search..." onkeyup="filterFiles()">
                <img src="https://img.icons8.com/ios-glyphs/30/000000/search--v1.png" class="search-icon">
            </div>
        </div>

        <div class="toolbar">
            <div class="tool-btn btn-add" onclick="openAddModal()">+ New Item</div>
            <div class="tool-btn btn-empty" id="btn-empty" onclick="emptyBin()">Empty Recycle Bin</div>
            <div class="tool-btn">Organize</div>
            <div class="tool-btn">Share with</div>
            <div class="tool-btn">Burn</div>
        </div>

        <div class="main-container">
            <div class="sidebar">
                <div class="tree-item indent-1 group-title">
                    <img src="https://img.icons8.com/color/48/star--v1.png" class="icon-16"> <span style="margin-left:5px">Favorites</span>
                </div>
                <div class="tree-item indent-2" onclick="nav('Desktop')">
                    <img src="https://img.icons8.com/color/48/desktop-mac.png" class="icon-16"> <span style="margin-left:5px">Desktop</span>
                </div>
                <div class="tree-item indent-2" onclick="nav('Downloads')">
                    <img src="https://img.icons8.com/color/48/download--v1.png" class="icon-16"> <span style="margin-left:5px">Downloads</span>
                </div>
                
                <div class="tree-item indent-1 group-title" style="margin-top:10px;">
                    <img src="https://img.icons8.com/color/48/books.png" class="icon-16"> <span style="margin-left:5px">Libraries</span>
                </div>
                <div class="tree-item indent-2 active" id="node-Pictures" onclick="nav('Pictures')">
                    <img src="https://img.icons8.com/color/48/image-file.png" class="icon-16"> <span style="margin-left:5px">Pictures</span>
                </div>
                <div class="tree-item indent-2" id="node-Videos" onclick="nav('Videos')">
                    <img src="https://img.icons8.com/color/48/video-file.png" class="icon-16"> <span style="margin-left:5px">Videos</span>
                </div>
                <div class="tree-item indent-2" id="node-Music" onclick="nav('Music')">
                    <img src="https://img.icons8.com/color/48/musical-notes.png" class="icon-16"> <span style="margin-left:5px">Music</span>
                </div>

                <div class="tree-item indent-1 group-title" style="margin-top:10px;">
                    <img src="https://img.icons8.com/color/48/trash.png" class="icon-16"> <span style="margin-left:5px">System</span>
                </div>
                <div class="tree-item indent-2" id="node-Recycle Bin" onclick="nav('Recycle Bin')">
                    <img src="https://img.icons8.com/color/48/trash.png" class="icon-16"> <span style="margin-left:5px">Recycle Bin</span>
                </div>
            </div>

            <div class="file-view" id="file-grid"></div>
        </div>

        <div style="height:28px; background:#f5f6f7; border-top:1px solid #ddd; padding:0 10px; display:flex; align-items:center; color:#555; font-size:11px;">
            <span id="status-count">Items: 0</span>
        </div>
    </div>

    <div id="preview-window" class="hidden">
        <div class="popup-header">
            <img src="https://img.icons8.com/color/48/opened-folder.png" style="width:16px; margin-right:5px;">
            <span id="prev-title" style="flex-grow:1; font-weight:bold; text-shadow:0 1px 0 rgba(255,255,255,0.8);">Preview</span>
            <div class="win-controls">
                <div class="win-btn" onclick="toggleMinimize()">_</div>
                <div class="win-btn" onclick="toggleMaximize()">▢</div>
                <div class="win-btn close-btn" onclick="closePreview()">×</div>
            </div>
        </div>
        <div class="popup-content-view" id="prev-content"></div>
    </div>

    <div id="add-window" class="hidden">
        <div class="popup-header"><span>Create New File</span><span style="cursor:pointer; padding: 0 10px;" onclick="closeAddModal()">×</span></div>
        <div class="popup-body">
            <div class="form-group">
                <label>File Name:</label>
                <input type="text" id="inp-name" value="MyVideo.mp4">
            </div>
            <div class="form-group">
                <label>Type:</label>
                <select id="inp-type">
                    <option value="video">Video URL</option>
                    <option value="code">Code / Text</option>
                    <option value="img">Image URL</option>
                </select>
            </div>
            <div class="form-group">
                <label>Content / Source URL:</label>
                <input type="text" id="inp-src" placeholder="http://...">
            </div>
            <div style="text-align:right; margin-top:15px;">
                <button class="btn-win" onclick="saveFile()">Create</button>
                <button class="btn-win" onclick="closeAddModal()">Cancel</button>
            </div>
        </div>
    </div>

    <div id="del-window" class="hidden">
        <div class="popup-header"><span>Delete File</span></div>
        <div class="popup-body">
            <div style="display:flex; align-items:center; gap:15px; padding-bottom:15px;">
                <img src="https://img.icons8.com/color/48/trash.png">
                <div>Are you sure you want to move <b id="del-name">file</b> to the Recycle Bin?</div>
            </div>
            <div style="text-align:right;">
                <button class="btn-win" onclick="confirmDelete()">Yes</button>
                <button class="btn-win" onclick="closeDelModal()">No</button>
            </div>
        </div>
    </div>

    <div id="taskbar">
        <div class="start-btn"><div class="orb-img">W</div></div>
        <div id="taskbar-apps" style="display:flex; height:100%;"></div>
        <div style="flex-grow:1;"></div>
        <div class="tray-area">
            <img src="https://img.icons8.com/ios-filled/50/ffffff/wifi--v1.png" style="width:16px;">
            <div id="clock">12:00</div>
        </div>
    </div>

    <script>
        let fileSystem = {
    'Pictures': [
        { id: 1, name: 'Mountain.jpg', type: 'img', src: 'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=500', icon: 'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=100' },
        { id: 2, name: 'n.jpg', type: 'img', src: 'n.jpg', icon: 'n.jpg' } // Added your image here
    ],
    'Videos': [
        { id: 10, name: 'BigBuckBunny.mp4', type: 'video', src: 'https://www.w3schools.com/html/mov_bbb.mp4', icon: 'https://img.icons8.com/color/48/video-file.png' },
        { id: 11, name: 'indu.mp4', type: 'video', src: 'indu.mp4', icon: 'https://img.icons8.com/color/48/video-file.png' } // Added your n1.mp4 here
    ],
    'Music': [{ id: 3, name: 'Track01.mp3', type: 'mp3', icon: 'https://img.icons8.com/color/48/audio-file.png' }],
    'Desktop': [{ id: 4, name: 'ToDo.txt', type: 'code', src: '1. Buy Milk\n2. Code Windows Sim', icon: 'https://img.icons8.com/color/48/txt.png' }],
    'Downloads': [],
    'Recycle Bin': []
};


        let currentFolder = 'Pictures', deleteTargetId = null, activeFile = null;

        function nav(folder) {
            currentFolder = folder;
            document.querySelectorAll('.tree-item').forEach(el => el.classList.remove('active'));
            let node = document.getElementById('node-' + folder);
            if(node) node.classList.add('active');
            document.getElementById('address-path').innerText = folder === 'Recycle Bin' ? 'Recycle Bin' : `Libraries > ${folder}`;
            document.getElementById('btn-empty').style.display = (folder === 'Recycle Bin') ? 'block' : 'none';
            render();
        }

        function render(customList = null) {
            const grid = document.getElementById('file-grid');
            grid.innerHTML = "";
            const files = customList || fileSystem[currentFolder] || [];
            document.getElementById('status-count').innerText = `Items: ${files.length}`;
            files.forEach(file => {
                const el = document.createElement('div');
                el.className = 'file-card';
                el.innerHTML = `<img src="${file.icon || 'https://img.icons8.com/color/48/file.png'}" class="icon-48"><div class="file-label">${file.name}</div>`;
                el.onclick = () => { document.querySelectorAll('.file-card').forEach(c => c.classList.remove('selected')); el.classList.add('selected'); };
                el.ondblclick = () => openPreview(file);
                addLongPress(el, () => promptDelete(file));
                grid.appendChild(el);
            });
        }

        function openPreview(file) {
            activeFile = file;
            const win = document.getElementById('preview-window');
            const content = document.getElementById('prev-content');
            document.getElementById('prev-title').innerText = file.name;
            win.classList.remove('hidden'); win.classList.remove('minimized'); win.style.display = 'flex';
            if(file.type === 'img') content.innerHTML = `<img src="${file.src}" style="max-width:100%; max-height:100%;">`;
            else if(file.type === 'video') content.innerHTML = `<video src="${file.src}" controls autoplay style="width:100%; height:100%;"></video>`;
            else content.innerHTML = `<textarea style="width:100%; height:100%; background:#222; color:#0f0; border:none; padding:10px; font-family:monospace;">${file.src || ""}</textarea>`;
            updateTaskbar();
        }

        function closePreview() { document.getElementById('preview-window').classList.add('hidden'); document.getElementById('prev-content').innerHTML = ""; activeFile = null; updateTaskbar(); }
        function toggleMinimize() { document.getElementById('preview-window').classList.toggle('minimized'); updateTaskbar(); }
        function toggleMaximize() { document.getElementById('preview-window').classList.toggle('maximized'); }

        function updateTaskbar() {
            const container = document.getElementById('taskbar-apps');
            if(!activeFile) { container.innerHTML = ''; return; }
            const isMin = document.getElementById('preview-window').classList.contains('minimized');
            container.innerHTML = `<div class="task-item ${!isMin ? 'active' : ''}" onclick="document.getElementById('preview-window').classList.remove('minimized'); updateTaskbar();"><img src="${activeFile.icon}" class="icon-16"><span>${activeFile.name}</span></div>`;
        }

        /* --- FIXED PRO DRAG LOGIC: DRAG BY CLICKING ANYWHERE --- */
        makeDraggable(document.getElementById('preview-window'));
        makeDraggable(document.getElementById('add-window'));
        makeDraggable(document.getElementById('del-window'));

        function makeDraggable(element) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            
            // Drag on ANY part of the window
            element.onmousedown = dragStart;
            element.ontouchstart = dragStart;

            function dragStart(e) {
                // DON'T drag if clicking an input, button, or textarea
                const tag = e.target.tagName.toLowerCase();
                if(['input', 'button', 'select', 'textarea', 'video'].includes(tag) || e.target.closest('.win-controls')) return;

                if(element.classList.contains('maximized')) return;
                
                const clientX = e.type === 'touchstart' ? e.touches[0].clientX : e.clientX;
                const clientY = e.type === 'touchstart' ? e.touches[0].clientY : e.clientY;

                pos3 = clientX;
                pos4 = clientY;
                
                document.onmouseup = closeDrag;
                document.onmousemove = elementDrag;
                document.ontouchend = closeDrag;
                document.ontouchmove = elementDrag;
            }

            function elementDrag(e) {
                if (e.cancelable) e.preventDefault();
                const clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
                const clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY;

                pos1 = pos3 - clientX;
                pos2 = pos4 - clientY;
                pos3 = clientX;
                pos4 = clientY;
                element.style.top = (element.offsetTop - pos2) + "px";
                element.style.left = (element.offsetLeft - pos1) + "px";
            }

            function closeDrag() {
                document.onmouseup = null; document.onmousemove = null;
                document.ontouchend = null; document.ontouchmove = null;
            }
        }

        function filterFiles() {
            const query = document.getElementById('search-inp').value.toLowerCase();
            render(fileSystem[currentFolder].filter(f => f.name.toLowerCase().includes(query)));
        }

        function addLongPress(el, action) {
            let timer;
            el.addEventListener('mousedown', () => timer = setTimeout(action, 800));
            el.addEventListener('touchstart', () => timer = setTimeout(action, 800));
            el.addEventListener('mouseup', () => clearTimeout(timer));
            el.addEventListener('touchend', () => clearTimeout(timer));
        }

        function promptDelete(file) { deleteTargetId = file.id; document.getElementById('del-name').innerText = file.name; document.getElementById('del-window').classList.remove('hidden'); }
        function confirmDelete() { 
            const list = fileSystem[currentFolder];
            const idx = list.findIndex(f => f.id === deleteTargetId);
            if(idx > -1) {
                if(currentFolder !== 'Recycle Bin') fileSystem['Recycle Bin'].push(list.splice(idx, 1)[0]);
                else list.splice(idx, 1);
            }
            closeDelModal(); render();
        }
        function closeDelModal() { document.getElementById('del-window').classList.add('hidden'); }
        function openAddModal() { document.getElementById('add-window').classList.remove('hidden'); }
        function closeAddModal() { document.getElementById('add-window').classList.add('hidden'); }
        function saveFile() {
            const name = document.getElementById('inp-name').value;
            const type = document.getElementById('inp-type').value;
            const src = document.getElementById('inp-src').value;
            if(!name) return;
            fileSystem[currentFolder].push({ id: Date.now(), name, type, src, icon: type === 'video' ? 'https://img.icons8.com/color/48/video-file.png' : (type==='img'?src:'https://img.icons8.com/color/48/file.png') });
            closeAddModal(); render();
        }

        setInterval(() => { const d = new Date(); document.getElementById('clock').innerText = `${d.getHours()}:${String(d.getMinutes()).padStart(2,'0')}`; }, 1000);
        nav('Pictures');
    </script>
</body>
</html>
